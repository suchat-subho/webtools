<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>WebRTC Sender (Page 1)</title>
</head>
<body>
  <h2>Page 1 - Sender</h2>
  <textarea id="offer" rows="6" cols="60" placeholder="Offer (auto generated)"></textarea><br>
  <button id="createOffer">Create Offer</button>
  <br><br>
  <textarea id="answer" rows="6" cols="60" placeholder="Paste Answer here"></textarea><br>
  <button id="setAnswer">Set Answer</button>
  <br><br>
  <input id="message" placeholder="Message to send" />
  <button id="send">Send</button>
  <pre id="log"></pre>

  <script>
    let pc = new RTCPeerConnection();
    let channel = pc.createDataChannel("chat");

    channel.onopen = () => log("Channel open!");
    channel.onmessage = e => log("Received: " + e.data);

    function log(msg) {
      document.getElementById("log").textContent += msg + "\n";
    }

    document.getElementById("createOffer").onclick = async () => {
      let offer = await pc.createOffer();
      await pc.setLocalDescription(offer);
      document.getElementById("offer").value = JSON.stringify(offer);
    };

    document.getElementById("setAnswer").onclick = async () => {
      let answer = JSON.parse(document.getElementById("answer").value);
      await pc.setRemoteDescription(answer);
      log("Answer set!");
    };

    document.getElementById("send").onclick = () => {
      let msg = document.getElementById("message").value;
      channel.send(msg);
      log("Sent: " + msg);
    };
  </script>
</body>
</html>
